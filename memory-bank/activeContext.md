# アクティブコンテキスト

## 現在の作業の焦点

フロントエンド開発の基盤構築が完了し、現在は基本的なUIコンポーネントの実装とReact Flowを用いたツリー表示機能の開発に焦点を当てています。Next.jsプロジェクトのセットアップ、Tailwind CSS + shadcn/uiの統合、および3つの主要領域（サイドバー、チャット領域、ツリー表示領域）の基本レイアウトが完成しています。

## 最近の変更

*   Next.jsプロジェクト（TypeScript、ESLint、Tailwind CSS、App Router対応）のセットアップを完了
*   shadcn/uiの統合を完了
*   `frontend/src/app/page.tsx`に基本的な3カラムレイアウトを実装
*   開発サーバー（http://localhost:3000）を起動
*   pnpmパッケージマネージャーのセットアップを完了

## 次のステップ

1.  React Flowライブラリの追加とツリー表示コンポーネントの実装
2.  Zustandを用いた状態管理の実装
3.  チャット機能の基本コンポーネント（MessageList、MessageInput、MessageBubble）の実装
4.  設定モーダルの実装
5.  WebSocket通信の準備

## アクティブな決定と考慮事項

*   **LLMプロバイダーの選択**: 複数のLLMプロバイダーに対応する設計ですが、初期開発では特定のプロバイダー（例: OpenAI）に焦点を当て、後で拡張性を確保することを検討します。
*   **状態管理ライブラリの選択**: フロントエンドの状態管理にZustandとRecoilが候補に挙がっています。どちらがプロジェクトのニーズに最適か、または両方を組み合わせるかについて、今後の開発で決定します。
*   **会話ブランチの深さ**: LLMへの入力コンテキストの`max_tokens`制限を考慮し、会話ブランチの深さがパフォーマンスやコストに与える影響を評価する必要があります。

## 重要なパターンと好み

*   **クリーンアーキテクチャ**: フロントエンドとバックエンドの分離を明確にし、各層の責務を明確にすることで、保守性と拡張性を高めます。
*   **テスト駆動開発 (TDD)**: 可能であれば、主要なロジック（特に会話ブランチの管理やLLMコンテキストの準備）に対してTDDアプローチを採用し、堅牢性を確保します。

## 学習とプロジェクトの洞察

*   会話のツリー構造を効率的に管理するためのデータベーススキーマ設計が重要です。`parent_id`による階層構造は、Gitのようなブランチ管理を模倣する上で適切です。
*   リアルタイム通信の要件は、フロントエンドとバックエンド間のデータ同期においてWebSocket/SSEの適切な実装を必要とします。
